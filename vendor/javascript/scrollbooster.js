var e="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:global;var p={};!function(e,c){p=c()}(p,(function(){return function(e){var p={};function i(c){if(p[c])return p[c].exports;var h=p[c]={i:c,l:!1,exports:{}};return e[c].call(h.exports,h,h.exports,i),h.l=!0,h.exports}return i.m=e,i.c=p,i.d=function(e,p,c){i.o(e,p)||Object.defineProperty(e,p,{enumerable:!0,get:c})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,p){if(1&p&&(e=i(e)),8&p)return e;if(4&p&&"object"==typeof e&&e&&e.__esModule)return e;var c=Object.create(null);if(i.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:e}),2&p&&"string"!=typeof e)for(var h in e)i.d(c,h,function(p){return e[p]}.bind(null,h));return c},i.n=function(e){var p=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(p,"a",p),p},i.o=function(e,p){return Object.prototype.hasOwnProperty.call(e,p)},i.p="",i(i.s=0)}([function(p,c,h){function o(e,p){var c=Object.keys(e);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(e);p&&(h=h.filter((function(p){return Object.getOwnPropertyDescriptor(e,p).enumerable}))),c.push.apply(c,h)}return c}function n(e){for(var p=1;p<arguments.length;p++){var c=null!=arguments[p]?arguments[p]:{};p%2?o(Object(c),!0).forEach((function(p){r(e,p,c[p])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):o(Object(c)).forEach((function(p){Object.defineProperty(e,p,Object.getOwnPropertyDescriptor(c,p))}))}return e}function r(e,p,c){return p in e?Object.defineProperty(e,p,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[p]=c,e}function s(e,p){if(!(e instanceof p))throw new TypeError("Cannot call a class as a function")}function a(e,p){for(var c=0;c<p.length;c++){var h=p[c];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(e,h.key,h)}}h.r(c),h.d(c,"default",(function(){return u}));var l=function(e){return Math.max(e.offsetHeight,e.scrollHeight)},u=function(){function t(){var p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this||e,t);var c={content:p.viewport.children[0],direction:"all",pointerMode:"all",scrollMode:void 0,bounce:!0,bounceForce:.1,friction:.05,textSelection:!1,inputsFocus:!0,emulateScroll:!1,preventDefaultOnEmulateScroll:!1,preventPointerMoveDefault:!0,lockScrollOnDragDirection:!1,pointerDownPreventDefault:!0,dragDirectionTolerance:40,onPointerDown:function(){},onPointerUp:function(){},onPointerMove:function(){},onClick:function(){},onUpdate:function(){},onWheel:function(){},shouldScroll:function(){return!0}};if((this||e).props=n(n({},c),p),(this||e).props.viewport&&(this||e).props.viewport instanceof Element)if((this||e).props.content){(this||e).isDragging=!1,(this||e).isTargetScroll=!1,(this||e).isScrolling=!1,(this||e).isRunning=!1;var h={x:0,y:0};(this||e).position=n({},h),(this||e).velocity=n({},h),(this||e).dragStartPosition=n({},h),(this||e).dragOffset=n({},h),(this||e).clientOffset=n({},h),(this||e).dragPosition=n({},h),(this||e).targetPosition=n({},h),(this||e).scrollOffset=n({},h),(this||e).rafID=null,(this||e).events={},this.updateMetrics(),this.handleEvents()}else console.error("ScrollBooster init error: Viewport does not have any content");else console.error('ScrollBooster init error: "viewport" config property must be present and must be Element')}var p,c,h;return p=t,(c=[{key:"updateOptions",value:function(){var p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(this||e).props=n(n({},(this||e).props),p),(this||e).props.onUpdate(this.getState()),this.startAnimationLoop()}},{key:"updateMetrics",value:function(){var p;(this||e).viewport={width:(this||e).props.viewport.clientWidth,height:(this||e).props.viewport.clientHeight},(this||e).content={width:(p=(this||e).props.content,Math.max(p.offsetWidth,p.scrollWidth)),height:l((this||e).props.content)},(this||e).edgeX={from:Math.min(-(this||e).content.width+(this||e).viewport.width,0),to:0},(this||e).edgeY={from:Math.min(-(this||e).content.height+(this||e).viewport.height,0),to:0},(this||e).props.onUpdate(this.getState()),this.startAnimationLoop()}},{key:"startAnimationLoop",value:function(){var p=this||e;(this||e).isRunning=!0,cancelAnimationFrame((this||e).rafID),(this||e).rafID=requestAnimationFrame((function(){return p.animate()}))}},{key:"animate",value:function(){var p=this||e;if((this||e).isRunning){this.updateScrollPosition(),this.isMoving()||((this||e).isRunning=!1,(this||e).isTargetScroll=!1);var c=this.getState();this.setContentPosition(c),(this||e).props.onUpdate(c),(this||e).rafID=requestAnimationFrame((function(){return p.animate()}))}}},{key:"updateScrollPosition",value:function(){this.applyEdgeForce(),this.applyDragForce(),this.applyScrollForce(),this.applyTargetForce();var p=1-(this||e).props.friction;(this||e).velocity.x*=p,(this||e).velocity.y*=p,"vertical"!==(this||e).props.direction&&((this||e).position.x+=(this||e).velocity.x),"horizontal"!==(this||e).props.direction&&((this||e).position.y+=(this||e).velocity.y),(this||e).props.bounce&&!(this||e).isScrolling||(this||e).isTargetScroll||((this||e).position.x=Math.max(Math.min((this||e).position.x,(this||e).edgeX.to),(this||e).edgeX.from),(this||e).position.y=Math.max(Math.min((this||e).position.y,(this||e).edgeY.to),(this||e).edgeY.from))}},{key:"applyForce",value:function(p){(this||e).velocity.x+=p.x,(this||e).velocity.y+=p.y}},{key:"applyEdgeForce",value:function(){if((this||e).props.bounce&&!(this||e).isDragging){var p=(this||e).position.x<(this||e).edgeX.from,c=(this||e).position.x>(this||e).edgeX.to,h=(this||e).position.y<(this||e).edgeY.from,u=(this||e).position.y>(this||e).edgeY.to,f=p||c,v=h||u;if(f||v){var g=p?(this||e).edgeX.from:(this||e).edgeX.to,d=h?(this||e).edgeY.from:(this||e).edgeY.to,y=g-(this||e).position.x,m=d-(this||e).position.y,x={x:y*(this||e).props.bounceForce,y:m*(this||e).props.bounceForce},w=(this||e).position.x+((this||e).velocity.x+x.x)/(this||e).props.friction,O=(this||e).position.y+((this||e).velocity.y+x.y)/(this||e).props.friction;(p&&w>=(this||e).edgeX.from||c&&w<=(this||e).edgeX.to)&&(x.x=y*(this||e).props.bounceForce-(this||e).velocity.x),(h&&O>=(this||e).edgeY.from||u&&O<=(this||e).edgeY.to)&&(x.y=m*(this||e).props.bounceForce-(this||e).velocity.y),this.applyForce({x:f?x.x:0,y:v?x.y:0})}}}},{key:"applyDragForce",value:function(){if((this||e).isDragging){var p=(this||e).dragPosition.x-(this||e).position.x,c=(this||e).dragPosition.y-(this||e).position.y;this.applyForce({x:p-(this||e).velocity.x,y:c-(this||e).velocity.y})}}},{key:"applyScrollForce",value:function(){(this||e).isScrolling&&(this.applyForce({x:(this||e).scrollOffset.x-(this||e).velocity.x,y:(this||e).scrollOffset.y-(this||e).velocity.y}),(this||e).scrollOffset.x=0,(this||e).scrollOffset.y=0)}},{key:"applyTargetForce",value:function(){(this||e).isTargetScroll&&this.applyForce({x:.08*((this||e).targetPosition.x-(this||e).position.x)-(this||e).velocity.x,y:.08*((this||e).targetPosition.y-(this||e).position.y)-(this||e).velocity.y})}},{key:"isMoving",value:function(){return(this||e).isDragging||(this||e).isScrolling||Math.abs((this||e).velocity.x)>=.01||Math.abs((this||e).velocity.y)>=.01}},{key:"scrollTo",value:function(){var p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(this||e).isTargetScroll=!0,(this||e).targetPosition.x=-p.x||0,(this||e).targetPosition.y=-p.y||0,this.startAnimationLoop()}},{key:"setPosition",value:function(){var p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(this||e).velocity.x=0,(this||e).velocity.y=0,(this||e).position.x=-p.x||0,(this||e).position.y=-p.y||0,this.startAnimationLoop()}},{key:"getState",value:function(){return{isMoving:this.isMoving(),isDragging:!(!(this||e).dragOffset.x&&!(this||e).dragOffset.y),position:{x:-(this||e).position.x,y:-(this||e).position.y},dragOffset:(this||e).dragOffset,dragAngle:this.getDragAngle((this||e).clientOffset.x,(this||e).clientOffset.y),borderCollision:{left:(this||e).position.x>=(this||e).edgeX.to,right:(this||e).position.x<=(this||e).edgeX.from,top:(this||e).position.y>=(this||e).edgeY.to,bottom:(this||e).position.y<=(this||e).edgeY.from}}}},{key:"getDragAngle",value:function(e,p){return Math.round(Math.atan2(e,p)*(180/Math.PI))}},{key:"getDragDirection",value:function(e,p){return Math.abs(90-Math.abs(e))<=90-p?"horizontal":"vertical"}},{key:"setContentPosition",value:function(p){"transform"===(this||e).props.scrollMode&&((this||e).props.content.style.transform="translate(".concat(-p.position.x,"px, ").concat(-p.position.y,"px)")),"native"===(this||e).props.scrollMode&&((this||e).props.viewport.scrollTop=p.position.y,(this||e).props.viewport.scrollLeft=p.position.x)}},{key:"handleEvents",value:function(){var p=this||e,c={x:0,y:0},h={x:0,y:0},u=null,f=null,v=!1,s=function(e){if(p.isDragging){var f=v?e.touches[0]:e,g=f.pageX,d=f.pageY,y=f.clientX,m=f.clientY;p.dragOffset.x=g-c.x,p.dragOffset.y=d-c.y,p.clientOffset.x=y-h.x,p.clientOffset.y=m-h.y,(Math.abs(p.clientOffset.x)>5&&!u||Math.abs(p.clientOffset.y)>5&&!u)&&(u=p.getDragDirection(p.getDragAngle(p.clientOffset.x,p.clientOffset.y),p.props.dragDirectionTolerance)),p.props.lockScrollOnDragDirection&&"all"!==p.props.lockScrollOnDragDirection?u===p.props.lockScrollOnDragDirection&&v?(p.dragPosition.x=p.dragStartPosition.x+p.dragOffset.x,p.dragPosition.y=p.dragStartPosition.y+p.dragOffset.y):v?(p.dragPosition.x=p.dragStartPosition.x,p.dragPosition.y=p.dragStartPosition.y):(p.dragPosition.x=p.dragStartPosition.x+p.dragOffset.x,p.dragPosition.y=p.dragStartPosition.y+p.dragOffset.y):(p.dragPosition.x=p.dragStartPosition.x+p.dragOffset.x,p.dragPosition.y=p.dragStartPosition.y+p.dragOffset.y)}};(this||e).events.pointerdown=function(e){v=!(!e.touches||!e.touches[0]),p.props.onPointerDown(p.getState(),e,v);var u=v?e.touches[0]:e,f=u.pageX,g=u.pageY,d=u.clientX,y=u.clientY,m=p.props.viewport,x=m.getBoundingClientRect();if(!(d-x.left>=m.clientLeft+m.clientWidth)&&!(y-x.top>=m.clientTop+m.clientHeight)&&p.props.shouldScroll(p.getState(),e)&&2!==e.button&&("mouse"!==p.props.pointerMode||!v)&&("touch"!==p.props.pointerMode||v)&&!(p.props.inputsFocus&&["input","textarea","button","select","label"].indexOf(e.target.nodeName.toLowerCase())>-1)){if(p.props.textSelection){if(function(e,p,c){for(var h=e.childNodes,u=document.createRange(),f=0;f<h.length;f++){var v=h[f];if(3===v.nodeType){u.selectNodeContents(v);var g=u.getBoundingClientRect();if(p>=g.left&&c>=g.top&&p<=g.right&&c<=g.bottom)return v}}return!1}(e.target,d,y))return;(w=window.getSelection?window.getSelection():document.selection)&&(w.removeAllRanges?w.removeAllRanges():w.empty&&w.empty())}var w;p.isDragging=!0,c.x=f,c.y=g,h.x=d,h.y=y,p.dragStartPosition.x=p.position.x,p.dragStartPosition.y=p.position.y,s(e),p.startAnimationLoop(),!v&&p.props.pointerDownPreventDefault&&e.preventDefault()}},(this||e).events.pointermove=function(e){!e.cancelable||"all"!==p.props.lockScrollOnDragDirection&&p.props.lockScrollOnDragDirection!==u||e.preventDefault(),s(e),p.props.onPointerMove(p.getState(),e,v)},(this||e).events.pointerup=function(e){p.isDragging=!1,u=null,p.props.onPointerUp(p.getState(),e,v)},(this||e).events.wheel=function(e){var c=p.getState();p.props.emulateScroll&&(p.velocity.x=0,p.velocity.y=0,p.isScrolling=!0,p.scrollOffset.x=-e.deltaX,p.scrollOffset.y=-e.deltaY,p.props.onWheel(c,e),p.startAnimationLoop(),clearTimeout(f),f=setTimeout((function(){return p.isScrolling=!1}),80),p.props.preventDefaultOnEmulateScroll&&p.getDragDirection(p.getDragAngle(-e.deltaX,-e.deltaY),p.props.dragDirectionTolerance)===p.props.preventDefaultOnEmulateScroll&&e.preventDefault())},(this||e).events.scroll=function(){var e=p.props.viewport,c=e.scrollLeft,h=e.scrollTop;Math.abs(p.position.x+c)>3&&(p.position.x=-c,p.velocity.x=0),Math.abs(p.position.y+h)>3&&(p.position.y=-h,p.velocity.y=0)},(this||e).events.click=function(e){var c=p.getState(),h="vertical"!==p.props.direction?c.dragOffset.x:0,u="horizontal"!==p.props.direction?c.dragOffset.y:0;Math.max(Math.abs(h),Math.abs(u))>5&&(e.preventDefault(),e.stopPropagation()),p.props.onClick(c,e,v)},(this||e).events.contentLoad=function(){return p.updateMetrics()},(this||e).events.resize=function(){return p.updateMetrics()},(this||e).props.viewport.addEventListener("mousedown",(this||e).events.pointerdown),(this||e).props.viewport.addEventListener("touchstart",(this||e).events.pointerdown,{passive:!1}),(this||e).props.viewport.addEventListener("click",(this||e).events.click),(this||e).props.viewport.addEventListener("wheel",(this||e).events.wheel,{passive:!1}),(this||e).props.viewport.addEventListener("scroll",(this||e).events.scroll),(this||e).props.content.addEventListener("load",(this||e).events.contentLoad,!0),window.addEventListener("mousemove",(this||e).events.pointermove),window.addEventListener("touchmove",(this||e).events.pointermove,{passive:!1}),window.addEventListener("mouseup",(this||e).events.pointerup),window.addEventListener("touchend",(this||e).events.pointerup),window.addEventListener("resize",(this||e).events.resize)}},{key:"destroy",value:function(){(this||e).props.viewport.removeEventListener("mousedown",(this||e).events.pointerdown),(this||e).props.viewport.removeEventListener("touchstart",(this||e).events.pointerdown),(this||e).props.viewport.removeEventListener("click",(this||e).events.click),(this||e).props.viewport.removeEventListener("wheel",(this||e).events.wheel),(this||e).props.viewport.removeEventListener("scroll",(this||e).events.scroll),(this||e).props.content.removeEventListener("load",(this||e).events.contentLoad),window.removeEventListener("mousemove",(this||e).events.pointermove),window.removeEventListener("touchmove",(this||e).events.pointermove),window.removeEventListener("mouseup",(this||e).events.pointerup),window.removeEventListener("touchend",(this||e).events.pointerup),window.removeEventListener("resize",(this||e).events.resize)}}])&&a(p.prototype,c),h&&a(p,h),t}()}]).default}));var c=p;const h=p.ScrollBooster;export default c;export{h as ScrollBooster};

